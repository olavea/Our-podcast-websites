---
import { getCollection } from "astro:content";
import Layout from "../../layouts/Layout.astro";
import Episode from "../../components/Episode.astro";

export async function getStaticPaths({ paginate }) {
  const episodes = await getCollection("episodes");
  const sortedEpisodes = episodes.sort((a, b) => {
    return b.data.number - a.data.number;
  });

  const pages = paginate(sortedEpisodes, { pageSize: 10 });

  return pages;
}

const { page } = Astro.props;
---

<Layout title="Our podcast websites">
  <main>
    {
      page.data.map((entry) => {
        return <Episode {...entry.data} />;
      })
    }

    <nav>
      <ul>
        <li>
          <a href={page.url.prev}>Previous</a>
        </li>
        <li>
          <a href={page.url.next}>Next</a>
        </li>
      </ul>
    </nav>
  </main>
</Layout>
