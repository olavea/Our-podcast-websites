---
import { fetchEpisodes } from "../../data";
import Layout from "../../layouts/Layout.astro";

export async function getStaticPaths({ paginate }) {
  const episodeData = await fetchEpisodes();

  const episodes = episodeData.map((data) => {
    return data.attributes;
  });

  const pages = paginate(episodes, { pageSize: 10 });

  return pages;
}

const { page } = Astro.props;
---

<Layout title="Our podcast websites">
  <main>
    {
      page.data.map((episode) => {
        return (
          <article>
            <h2>
              <a href={`/episodes/${episode.slug}`}>{episode.title}</a>
            </h2>
            <div set:html={episode.description} />
          </article>
        );
      })
    }

    <nav>
      <ul>
        <li>
          <a href={page.url.prev}>Previous</a>
        </li>
        <li>
          <a href={page.url.next}>Next</a>
        </li>
      </ul>
    </nav>
  </main>
</Layout>
